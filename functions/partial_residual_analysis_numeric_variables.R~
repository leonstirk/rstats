partial_resid_numeric_analysis <- function(vars, fit, data) {
  data <<- data
  ## Terms matrix
  terms <- predict(fit, type = "terms")
  ## Partials matrix #
  partial_residuals <- apply(terms,2,function(x)x+resid(fit))
  ## Effects output #
  l_eff <- list()
  for(i in 1:length(vars)) {
    l_eff[[vars[i]]]            <- effect(vars[i], fit, partial.residuals = TRUE)
    l_eff[[vars[i]]]$terms      <- terms[,i]
    l_eff[[vars[i]]]$partials   <- partial_residuals[,i]
    l_eff[[vars[i]]]$partials_y <- 
    l_eff[[vars[i]]]$sale_id    <- data$sale_id
  }
  data <- data.frame()
  return(l_eff)
}
