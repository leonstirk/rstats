rm(list=ls(all=TRUE))

chas <- read.dta13('datasets/chcGeordieData.dta')

# Drop variables
v <- names(chas) %in% c("land_area","agenum","floor_area2","twobeds","daynum","dafterxtc2","dafterxtc3")
chas <- chas[!v]
rm(v)

names(chas) <- c("qpid","sale_date","tc","sale_year","sale_quarter","net_sale_price","ln_sale_price","street_name","street_name_suffix","suburb","meshblock_id","area_unit_id","area_unit_name","median_income","ln_median_income","land_area","decade_built","floor_area","building_footprint_area","contour","view","view_scope","deck","mas_no_main_roof_garages","mas_free_standing_garages","wall_construction_material","roof_construction_material","bedrooms","tc2","tc3","bvsa","dafter")

i <- sapply(chas, is.factor)
chas[i] <- lapply(chas[i], as.character)

chas[chas==''] <- NA
chas[chas=='-'] <- NA

# Date variable conversion
chas$sale_date <- as.Date(chas$sale_date, '%Y-%m-%d')

## # Create new variables
## das$age_at_time_of_sale <- das$sale_year - das$year_built
## das$ln_building_floor_area <- log(das$building_floor_area)
## das$land_area <- das$land_area*100
## das$ln_land_area <- log(das$land_area)

## save(das, file="/home/rstudio/dud_allsales_2000to2018.Rda")
